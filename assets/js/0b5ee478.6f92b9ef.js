"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[695],{3905:function(e,n,t){t.r(n),t.d(n,{MDXContext:function(){return u},MDXProvider:function(){return p},mdx:function(){return f},useMDXComponents:function(){return s},withMDXComponents:function(){return c}});var l=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(){return i=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},i.apply(this,arguments)}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);n&&(l=l.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,l)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function d(e,n){if(null==e)return{};var t,l,r=function(e,n){if(null==e)return{};var t,l,r={},i=Object.keys(e);for(l=0;l<i.length;l++)t=i[l],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(l=0;l<i.length;l++)t=i[l],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var u=l.createContext({}),c=function(e){return function(n){var t=s(n.components);return l.createElement(e,i({},n,{components:t}))}},s=function(e){var n=l.useContext(u),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},p=function(e){var n=s(e.components);return l.createElement(u.Provider,{value:n},e.children)},m={inlineCode:"code",wrapper:function(e){var n=e.children;return l.createElement(l.Fragment,{},n)}},b=l.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,a=e.parentName,u=d(e,["components","mdxType","originalType","parentName"]),c=s(t),p=r,b=c["".concat(a,".").concat(p)]||c[p]||m[p]||i;return t?l.createElement(b,o(o({ref:n},u),{},{components:t})):l.createElement(b,o({ref:n},u))}));function f(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,a=new Array(i);a[0]=b;var o={};for(var d in n)hasOwnProperty.call(n,d)&&(o[d]=n[d]);o.originalType=e,o.mdxType="string"==typeof e?e:r,a[1]=o;for(var u=2;u<i;u++)a[u]=t[u];return l.createElement.apply(null,a)}return l.createElement.apply(null,t)}b.displayName="MDXCreateElement"},60487:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return o},contentTitle:function(){return d},metadata:function(){return u},toc:function(){return c},default:function(){return p}});var l=t(87462),r=t(63366),i=(t(67294),t(3905)),a=(t(44256),["components"]),o={id:"building",title:"Building Glean from Source",sidebar_label:"Building Glean"},d=void 0,u={unversionedId:"building",id:"building",isDocsHomePage:!1,title:"Building Glean from Source",description:"Introduction",source:"@site/docs/building.md",sourceDirName:".",slug:"/building",permalink:"/docs/building",editUrl:"https://github.com/facebookincubator/Glean/tree/main/glean/website/docs/building.md",tags:[],version:"current",frontMatter:{id:"building",title:"Building Glean from Source",sidebar_label:"Building Glean"},sidebar:"someSidebar",previous:{title:"Trying Glean",permalink:"/docs/trying"},next:{title:"Walkthrough",permalink:"/docs/walkthrough"}},c=[{value:"Introduction",id:"introduction",children:[],level:2},{value:"You will need",id:"you-will-need",children:[{value:"Ubuntu",id:"ubuntu",children:[],level:3},{value:"Debian",id:"debian",children:[],level:3},{value:"Fedora",id:"fedora",children:[],level:3}],level:2},{value:"Building",id:"building",children:[{value:"Build hsthrift and dependencies",id:"build-hsthrift-and-dependencies",children:[],level:3},{value:"Build Glean",id:"build-glean",children:[],level:3}],level:2}],s={toc:c};function p(e){var n=e.components,t=(0,r.Z)(e,a);return(0,i.mdx)("wrapper",(0,l.Z)({},s,t,{components:n,mdxType:"MDXLayout"}),(0,i.mdx)("h2",{id:"introduction"},"Introduction"),(0,i.mdx)("p",null,"Glean is written mainly in ",(0,i.mdx)("a",{parentName:"p",href:"http://www.haskell.org/"},"Haskell"),", and\nmakes heavy use of\n",(0,i.mdx)("a",{parentName:"p",href:"https://github.com/facebookincubator/hsthrift"},"Thrift")," for data\ncommunication and serialization, so these are the main dependencies\nthat are needed for building Glean."),(0,i.mdx)("h2",{id:"you-will-need"},"You will need"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("p",{parentName:"li"},"Linux. The build is only tested on Linux so far; we hope to add\nsupport for other OSs in the future. We have tested on x86","_","64 and arm64v8.")),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("p",{parentName:"li"},(0,i.mdx)("a",{parentName:"p",href:"https://www.haskell.org/ghc/"},"GHC"),". To see which versions Glean is tested with, check the current ",(0,i.mdx)("a",{parentName:"p",href:"https://github.com/facebookincubator/Glean/blob/master/.github/workflows/ci.yml"},"ci.yml")," script.")),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("p",{parentName:"li"},"Cabal/cabal-install version 3.6 or later (older versions won't work)."))),(0,i.mdx)("p",null,"Additional per-distribution setup follows."),(0,i.mdx)("h3",{id:"ubuntu"},"Ubuntu"),(0,i.mdx)("p",null,"Install prerequisite packages. (many of these are dependencies of\nhsthrift; an up to date list can be found in the\n",(0,i.mdx)("a",{parentName:"p",href:"https://github.com/facebookincubator/hsthrift/blob/master/.github/workflows/Dockerfile"},"Dockerfile"),"\nthat we use for building the base image for CI)."),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre"},"sudo apt-get install \\\n    g++ \\\n    cmake \\\n    bison flex \\\n    git cmake \\\n    libzstd-dev \\\n    libboost-all-dev \\\n    libevent-dev \\\n    libdouble-conversion-dev \\\n    libgoogle-glog-dev \\\n    libgflags-dev \\\n    libiberty-dev \\\n    liblz4-dev \\\n    liblzma-dev \\\n    libsnappy-dev \\\n    make \\\n    zlib1g-dev \\\n    binutils-dev \\\n    libjemalloc-dev \\\n    libssl-dev \\\n    pkg-config \\\n    libunwind-dev \\\n    libsodium-dev \\\n    curl \\\n    libpcre3-dev \\\n    libmysqlclient-dev \\\n    libfftw3-dev \\\n    libxxhash-dev\n")),(0,i.mdx)("h3",{id:"debian"},"Debian"),(0,i.mdx)("p",null,"The package dependencies for Debian current are the same as above for Ubuntu, except you may see:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre"}," Package 'libmysqlclient-dev' has no installation candidate\n")),(0,i.mdx)("p",null,"Use"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre"},"        default-libmysqlclient-dev\n")),(0,i.mdx)("p",null,"instead. You may also need to install:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre"},"        libfmt-dev\n")),(0,i.mdx)("h3",{id:"fedora"},"Fedora"),(0,i.mdx)("p",null,"Install prerequisite packages:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre"},"sudo dnf install \\\n    g++ \\\n    make \\\n    cmake \\\n    binutils \\\n    bison flex \\\n    curl \\\n    libzstd-devel \\\n    boost-devel \\\n    libevent-devel \\\n    double-conversion-devel \\\n    glog-devel \\\n    gflags-devel \\\n    zlib-devel \\\n    openssl-devel \\\n    libunwind-devel \\\n    libsodium-devel \\\n    pcre-devel \\\n    community-mysql-devel \\\n    fftw-devel \\\n    xxhash-devel\n")),(0,i.mdx)("h2",{id:"building"},"Building"),(0,i.mdx)("p",null,"Clone the repository:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre"},"git clone https://github.com/facebookincubator/Glean.git\ncd Glean\n")),(0,i.mdx)("h3",{id:"build-hsthrift-and-dependencies"},"Build hsthrift and dependencies"),(0,i.mdx)("p",null,"Glean depends on hsthrift, fbthrift, folly, rocksdb and some other core libraries.\nWe need to set paths to these that the Glean build can find the thrift compiler\nand associated libraries:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre"},"export LD_LIBRARY_PATH=$HOME/.hsthrift/lib:$LD_LIBRARY_PATH\nexport PKG_CONFIG_PATH=$HOME/lib/pkgconfig\nexport PATH=$PATH:$HOME/.hsthrift/bin\n")),(0,i.mdx)("p",null,"Now clone ",(0,i.mdx)("a",{parentName:"p",href:"https://github.com/facebookincubator/hsthrift"},"hsthrift")," and\nbuild and install its dependencies:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre"},"./install_deps.sh\n")),(0,i.mdx)("h3",{id:"build-glean"},"Build Glean"),(0,i.mdx)("p",null,"Now you can build all the Glean parts:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre"},"make\n")),(0,i.mdx)("p",null,"If everything worked, the tests should pass:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre"},"make test\n")),(0,i.mdx)("p",null,"At this point you can ",(0,i.mdx)("inlineCode",{parentName:"p"},"cabal install")," to install the executables into\n",(0,i.mdx)("inlineCode",{parentName:"p"},"~/.cabal/bin"),"."))}p.isMDXComponent=!0}}]);